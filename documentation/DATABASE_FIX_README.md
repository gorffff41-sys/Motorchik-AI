# Исправление ошибки "no such column: seats"

## Проблема
При запуске приложения возникала ошибка:
```
Ошибка поиска (search_all_cars): no such column: seats
```

Это происходило потому, что функция `search_all_cars` пыталась выбрать колонку `seats` из таблиц `car` и `used_car`, но эта колонка отсутствовала в базе данных.

## Решение

### 1. Автоматическая проверка колонок
Добавлена функция `ensure_required_columns_exists()` в `database.py`, которая:
- Автоматически проверяет наличие необходимых колонок при запуске
- Добавляет недостающие колонки (`seats`, `owners_count`) если их нет
- Заполняет колонку `seats` значениями по умолчанию на основе типа кузова

### 2. Динамическое определение колонок
Обновлена функция `_search_cars_with_filters()` для:
- Динамического определения доступных колонок в таблицах
- Формирования SQL-запросов только с существующими колонками
- Предотвращения ошибок "no such column"

### 3. Автоматический запуск при старте
- Функция проверки колонок автоматически вызывается при импорте модуля `database`
- Добавлен обработчик события запуска в `app.py` для дополнительной проверки

## Что происходит при запуске

1. **Автоматическая проверка**: При импорте модуля `database` автоматически проверяются все необходимые колонки
2. **Добавление недостающих**: Если колонки `seats` или `owners_count` отсутствуют, они автоматически создаются
3. **Заполнение данными**: Колонка `seats` заполняется значениями по умолчанию:
   - Купе/кабриолет/родстер: 2 места
   - Минивэн/микроавтобус: 7 мест  
   - Универсал/внедорожник: 5 мест
   - Остальные: 5 мест

## Результат

✅ **Ошибка исправлена**: Функция `search_all_cars` теперь работает без ошибок
✅ **Автоматическое исправление**: При каждом запуске приложения база данных автоматически проверяется и исправляется
✅ **Обратная совместимость**: Существующие данные не затрагиваются, добавляются только недостающие колонки

## Тестирование

Для проверки исправления запустите:
```bash
python test_database_fix.py
```

Этот скрипт проверит:
- Автоматическое добавление недостающих колонок
- Работу функции `search_all_cars`
- Корректность данных в новых колонках

## Файлы изменены

- `database.py` - добавлена функция `ensure_required_columns_exists()` и обновлена логика поиска
- `app.py` - добавлен автоматический вызов проверки колонок при запуске
- `test_database_fix.py` - создан тестовый скрипт для проверки исправления
